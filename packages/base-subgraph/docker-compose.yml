services:
  graph-node:
    image: graphprotocol/graph-node:latest
    ports:
      - "8000:8000"  # GraphQL endpoint
      - "8020:8020"  # Subgraph deployment endpoint
      - "8030:8030"  # GraphQL WebSocket endpoint
    environment:
      # PostgreSQL connection
      postgres_host: postgres
      postgres_user: postgres
      postgres_pass: password
      postgres_db: graph-node
      # Ethereum networks configuration
      ethereum: 
        mainnet: https://mainnet.gateway.tenderly.co/5vrOW3c7szhbvTCPc9WCf6
        base: https://base.gateway.tenderly.co/5vrOW3c7szhbvTCPc9WCf6
      # IPFS node
      ipfs: http://ipfs:5001

      # Optionally, specify any additional networks or settings
      # e.g., enable_ethereum: "true" (if required)

    depends_on:
      - postgres
      - ipfs

  postgres:
    image: postgres:12
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
      POSTGRES_DB: graph-node

  ipfs:
    image: ipfs/go-ipfs:latest
    ports:
      - "5001:5001"